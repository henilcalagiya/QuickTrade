{% extends 'base.html' %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card login-card">
                <div class="card-body p-5 text-center">
                    <div class="authentication-status mb-4">
                        <div class="status-icon processing mb-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        <h3 class="fw-bold mb-3">Processing Authentication</h3>
                        <p class="text-muted">Please wait while we complete your authentication</p>
                    </div>
                    
                    <div class="progress mb-4">
                        <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    
                    <p class="text-muted small">You will be redirected to dashboard automatically</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .login-card {
        border: none;
        box-shadow: var(--shadow-lg);
        border-radius: var(--border-radius-lg);
    }
    
    .authentication-status {
        padding: 2rem 0;
    }
    
    .status-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background-color: rgba(37, 99, 235, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto;
    }
    
    .status-icon.success {
        background-color: rgba(16, 185, 129, 0.1);
    }
    
    .status-icon.error {
        background-color: rgba(239, 68, 68, 0.1);
    }
    
    .progress {
        height: 8px;
        border-radius: 50px;
        background-color: var(--border-color);
    }
</style>

<script>
    // Initialize variables for animation
    let progressBar = document.querySelector('.progress-bar');
    let currentWidth = 75;
    
    // Animate progress bar
    const interval = setInterval(function() {
        if (currentWidth < 100) {
            currentWidth += 5;
            progressBar.style.width = currentWidth + '%';
            progressBar.setAttribute('aria-valuenow', currentWidth);
        } else {
            clearInterval(interval);
        }
    }, 100);
    
    // Show success state before redirecting
    setTimeout(function() {
        const statusIcon = document.querySelector('.status-icon');
        const statusTitle = document.querySelector('.fw-bold');
        const statusDesc = document.querySelector('.text-muted');
        
        // Update to success state
        statusIcon.classList.remove('processing');
        statusIcon.classList.add('success');
        statusIcon.innerHTML = '<i class="fas fa-check-circle fa-3x text-success"></i>';
        statusTitle.textContent = 'Authentication Successful';
        statusDesc.textContent = 'You have been successfully authenticated with Fyers';
        
        // Redirect after showing success state
        setTimeout(function() {
            window.location.href = '/dashboard/';
        }, 1000);
    }, 2000);
</script>
{% endblock %} 